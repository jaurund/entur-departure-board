!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},l=(new e.Error).stack;l&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[l]="4a786d6b-a9b9-4721-8d9c-95d7b04db717",e._sentryDebugIdIdentifier="sentry-dbid-4a786d6b-a9b9-4721-8d9c-95d7b04db717")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6023],{38470:(e,l,n)=>{n.d(l,{TileSelector:()=>y});var t=n(71983),i=n(22043),a=n(91246),s=n(4524),r=n(1914),d=n(70094),o=n(38494),c=n(39054),u=n(98996),m=n(15856),f=n(65406),v=n(54830),p=n(61975),h=n(71450),x=n(26302),b=n(66174),g=n(84632),j=n(19668);function y(e){var l,n,y,k,N,S,_,C,w,L,A,T,B,I=e.action,M=(n=(l=(0,i._)((0,o.useState)([]),2))[0],y=l[1],N=(k=(0,i._)((0,o.useState)([]),2))[0],S=k[1],(0,o.useEffect)(()=>{(0,d.HX)().then(e=>y((0,c.kA)(e)))},[]),{counties:(0,o.useCallback)(()=>n,[n]),selectedCounties:N,setSelectedCounties:S}),O=M.counties,D=M.selectedCounties,E=M.setSelectedCounties,R=(_=D.map(e=>e.value),w=(C=(0,i._)((0,o.useState)(null),2))[0],L=C[1],A=(0,x.sf)(),T=(0,o.useRef)(0),{stopPlaceItems:(0,o.useCallback)(e=>(0,p._)(function(){return(0,h.YH)(this,function(l){switch(l.label){case 0:return""!==e&&(T.current+=1),[4,(0,d.v_)(e,_)];case 1:return[2,l.sent()]}})})(),[_,T]),selectedStopPlace:w,setSelectedStopPlace:e=>{e&&A.capture("EDIT_STOP_PLACE_SEARCH",{counties:_&&_.length>0,count:T.current}),L(e),T.current=0}}),P=R.stopPlaceItems,$=R.selectedStopPlace,F=R.setSelectedStopPlace,V=function(e){var l=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=(0,f.I)(m.Uw,{stopPlaceId:e}).data,t=(0,i._)((0,o.useState)(null),2),a=t[0],s=t[1];(0,o.useEffect)(()=>s(null),[e]);var r=(0,o.useMemo)(()=>{var e,t;return(null==n||null==(t=n.stopPlace)||null==(e=t.quays)?void 0:e.filter(v.G).filter(e=>e.lines.some(e=>"air"!==e.transportMode)).sort((e,l)=>{if(e.publicCode&&l.publicCode)if(e.publicCode<l.publicCode)return -1;else return 1;if(e.publicCode)return -1;if(l.publicCode)return 1;var n,t,i=parseInt(null!=(n=e.id.split(":")[2])?n:"",10),a=parseInt(null!=(t=l.id.split(":")[2])?t:"",10);if(i&&a)if(i<a)return -1;else return 1;return e.id<l.id?-1:1}).map((e,n)=>{var t,i,a;return{value:e.id,label:(i=e.publicCode,a=e.description,i||a?[i,a].filter(v.G).join(" "):`${n+1}`),icons:null==(t=e.lines)?void 0:t.sort((e,l)=>{if(!e.publicCode||!l.publicCode)return 0;var n=e.publicCode.match(/[^$,.\d]/),t=l.publicCode.match(/[^$,.\d]/);return n&&!t?1:!n&&t||e.publicCode<l.publicCode?-1:1}).slice(0,5).map((n,t)=>{if(4===t){var i=()=>(0,u.A)({transportMode:"unknown",publicCode:`+${e.lines.length-t}`,icons:!1});return i.displayName=`SmallTravelTag-unknown-${e.id}-${t}`,i}var a=()=>(0,u.A)({transportMode:n.transportMode,publicCode:n.publicCode,icons:l});return a.displayName=`SmallTravelTag-${e.id}-${n.transportMode}-${t}`,a})}}).sort((e,l)=>e.label.localeCompare(l.label,"no-NB",{numeric:!0})))||[]},[n,l]),d=(0,o.useMemo)(()=>{var e,l;return(null==n||null==(l=n.stopPlace)||null==(e=l.quays)?void 0:e.filter(v.G).filter(e=>e.lines.some(e=>"air"===e.transportMode)).map(e=>({value:e.id,label:"Terminal",icons:[()=>(0,u.A)({transportMode:"air"})]})))||[]},[n]);return{quays:(0,o.useCallback)(()=>[{value:e,label:"Vis alle"},...r,...d],[r,d,e]),selectedQuay:a,setSelectedQuay:s}}(null!=(B=null==$?void 0:$.value)?B:""),G=V.quays,H=V.selectedQuay,U=V.setSelectedQuay,q=(0,x.sf)(),Y=(0,i._)((0,o.useState)(),2),X=Y[0],W=Y[1];return(0,a.jsxs)("form",{className:"mr-6 flex w-full flex-col gap-4 lg:flex-row",action:I,onSubmit:e=>{if(!$)return e.preventDefault(),W((0,b.f)($?"create/quay-missing":"create/stop_place-missing"));q.capture("ADD_TILE_TO_BOARD"),W(void 0),U(null),F(null)},children:[(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(s.KF,{label:"Fylker (valgfritt)",items:O,selectedItems:D,onChange:e=>{E(e)},clearInputOnSelect:!0,prepend:(0,a.jsx)(r.WIv,{"aria-hidden":!0}),maxChips:2,hideSelectAll:!0})}),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(s.qo,(0,t._)({items:e=>P(e||(null==$?void 0:$.label.split(",")[0])||""),label:"Stoppested",clearable:!0,prepend:(0,a.jsx)(r.WIv,{"aria-hidden":!0}),selectedItem:$,onChange:F,debounceTimeout:150},(0,b.X)("stop_place",X)))}),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(s.ms,(0,t._)({items:G,label:"Plattform/retning",prepend:(0,a.jsx)(r.WIv,{"aria-hidden":!0}),selectedItem:null!=H?H:{value:null==$?void 0:$.value,label:"Vis alle"},onChange:U,disabled:!$},(0,b.X)("quay",X)))}),(0,a.jsx)(g.t,{id:"stop_place",value:null==$?void 0:$.value}),(0,a.jsx)(g.t,{id:"stop_place_name",value:null==$?void 0:$.label}),(0,a.jsx)(g.t,{id:"quay_name",value:null==H?void 0:H.label}),(0,a.jsx)(g.t,{id:"quay",value:null==H?void 0:H.value}),(0,a.jsx)(j.b,{variant:"secondary",children:"Legg til"})]})}},60622:(e,l,n)=>{n.d(l,{Preview:()=>r});var t=n(91246),i=n(55747),a=n(29218),s=n(35925);function r(e){var l,n=e.board,r=e.folder;return(0,t.jsxs)("div",{className:"previewContainer md:text-2xl","data-theme":null!=(l=null==n?void 0:n.theme)?l:"dark",children:[(0,t.jsx)(a.Y,{theme:n.theme,folderLogo:null==r?void 0:r.logo,hideClock:n.hideClock,hideLogo:n.hideLogo}),(0,t.jsx)("div",{className:"h-96 md:h-[50rem]",children:(0,t.jsx)(i.b,{board:n})}),(0,t.jsx)(s.c,{board:n,showEnturLogo:(null==r?void 0:r.logo)!==void 0||(null==n?void 0:n.hideLogo)})]})}},70094:(e,l,n)=>{n.d(l,{HX:()=>o,Yr:()=>u,v_:()=>c});var t=n(61975),i=n(71450),a=n(80291),s=n(58179),r=n.n(s),d=n(99186);function o(){return(0,t._)(function(){return(0,i.YH)(this,function(e){return[2,fetch(a.vj).then(e=>e.json()).then(e=>e.map(e=>({value:e.fylkesnummer,label:e.fylkesnavn})))]})})()}function c(e,l){return(0,t._)(function(){var n;return(0,i.YH)(this,function(t){return!e||e.length<3?[2,[]]:(n=new URLSearchParams({lang:"no",size:"5",layers:"venue",text:e}),l&&l.length>0&&n.append("boundary.county_ids",l.join(",")),[2,fetch(`${a.V6}/autocomplete?${n}`,{headers:{"ET-Client-Name":a.eU}}).then(e=>e.json()).then(e=>e.features.map(e=>{var l,n=e.properties;return{value:null!=(l=n.id)?l:"",label:n.label||"",icons:r()((0,d.v8)(n.layer,n.category))}}))])})})()}function u(e){return(0,t._)(function(){var l;return(0,i.YH)(this,function(n){return!e||e.length<3?[2,[]]:(l=new URLSearchParams({lang:"no",size:"5",text:e}),[2,fetch(`${a.V6}/autocomplete?${l}`,{headers:{"ET-Client-Name":a.eU}}).then(e=>e.json()).then(e=>e.features.map(e=>{var l,n=e.properties,t=e.geometry;return{value:{name:null!=(l=n.label)?l:"",coordinate:{lat:t.coordinates[1],lng:t.coordinates[0]}},label:n.label||"",icons:(0,d.v8)(n.layer,n.category)}}))])})})()}},85967:(e,l,n)=>{n.d(l,{TileList:()=>en});var t=n(71983),i=n(45849),a=n(22043),s=n(91246),r=n(30926);let d=(0,r.createServerReference)("601c9fcc6eb84ca62b65157c3c19cf9b79802480e5",r.callServer,void 0,r.findSourceMapURL,"saveUpdatedTileOrder");var o=n(83693),c=n.n(o),u=n(38494),m=n(61975),f=n(71450),v=n(98212),p=n(61769),h=n(5500),x=n(39054),b=["VYG:Line:41","VYG:Line:45","VYG:Line:43","FLB:Line:42","VYG:Line:70","NSB:Line:R20","NSB:Line:RX20","NSB:Line:L21","NSB:Line:L22","NSB:Line:R23","NSB:Line:R23x","NSB:Line:L2","NSB:Line:L2x","GJB:Line:R30","GJB:Line:L3","NSB:Line:R10","NSB:Line:R11","NSB:Line:RX11","NSB:Line:L12","NSB:Line:L13","NSB:Line:R13x","NSB:Line:L14","NSB:Line:52","NSB:Line:L1"],g=n(99186),j=n(66174),y=n(65060),k=n(44744),N=n(63270),S=n.n(N);let _=(0,r.createServerReference)("604dac85765b32bf9431a2677e9e6463720be95abb",r.callServer,void 0,r.findSourceMapURL,"saveTile"),C=(0,r.createServerReference)("6019b25fb43b5f7cc624bd40726ce3eec71c21c2c8",r.callServer,void 0,r.findSourceMapURL,"deleteTile");var w=n(91576),L=n(1914),A=n(44650);function T(e){var l=e.isWideScreen,n=e.deleteTile,t=(0,s.jsxs)(w.cE,{onClick:n,"aria-label":"Fjern stoppested",type:"button",width:"fluid",className:l?"!min-w-0":"",children:[(0,s.jsx)(L.d7y,{}),!l&&(0,s.jsx)(s.Fragment,{children:"Fjern stoppested"})]});return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:l?"hidden sm:block":"sm:hidden",children:l?(0,s.jsx)(A.m_,{placement:"bottom",content:"Fjern stoppested",id:"tooltip-remove-tile",children:t}):t})})}function B(e){var l=e.isTileOpen,n=e.hasTileChanged,t=e.setIsTileOpen,i=e.setConfirmOpen,a=e.deleteTile;return(0,s.jsxs)("div",{className:"flex gap-md",children:[(0,s.jsx)(A.m_,{placement:"bottom",content:"Rediger stoppested",id:"tooltip-edit-tile",children:(0,s.jsx)(w.Yk,{onClick:()=>{if(n)return i(!0);t(!l)},"aria-label":"Rediger stoppested",children:l?(0,s.jsx)(L.USm,{}):(0,s.jsx)(L.qUP,{})})}),(0,s.jsx)(T,{isWideScreen:!0,deleteTile:a})]})}var I=n(10771);let M={src:"/_next/static/media/Goat.d1f3ed53.png",height:1501,width:1500,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEVMaXHb3efR0d7j4+qclaiQjaPr5+k8M1x1cZXg3ufAwdCofnuVkaTEvMfOz93S0tzv7/S1tcf///+oaWtIAAAAEnRSTlMAzp7VZDD4CyBp6FVBXMPf6El13JIYAAAACXBIWXMAABYlAAAWJQFJUiTwAAAANklEQVR4nEWKuRGAMBDEdPhZv4Ddf7HMnAOUSIHgJ8Vywm65Z861LlAa795B0KM97QJUQOdyPiHLAQIrV84aAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8};var O=n(19668),D=n(7383),E=n(15239);function R(e){var l=e.confirmOpen,n=e.hasTileChanged,t=e.resetTile,i=e.setIsTileOpen,a=e.setConfirmOpen,r=e.deleteTile,d=e.validation,o=(0,D.x)(y._);return(0,s.jsxs)(s.Fragment,{children:[(null==d?void 0:d.feedback)&&(0,s.jsx)(v.f,{variant:"warning",className:"mt-8 w-fit",children:d.feedback}),(0,s.jsxs)("div",{className:"mt-8 flex flex-col justify-start gap-4 md:flex-row",children:[(0,s.jsx)(O.b,{variant:"primary","aria-label":"lagre valg",children:"Lagre valg"}),(0,s.jsx)(w.$n,{variant:"secondary","aria-label":"avbryt",type:"button",onClick:()=>n?a(!0):i(!1),children:"Avbryt"}),(0,s.jsx)(T,{isWideScreen:!1,deleteTile:r})]}),(0,s.jsxs)(I.aF,{size:"small",open:l,onDismiss:t,closeLabel:"Avbryt endring",children:[(0,s.jsx)(w.K0,{"aria-label":"Lukk",onClick:t,className:"absolute right-4 top-4",children:(0,s.jsx)(L.USm,{})}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)(E.default,{alt:"",src:M,className:"h-1/2 w-1/2"}),(0,s.jsx)(h._B,{margin:"bottom",as:"h1",children:"Lagre endringer"}),(0,s.jsx)(h.fz,{children:"Du har endringer som ikke er lagret."}),(0,s.jsxs)(w.e2,{className:"flex flex-row",children:[(0,s.jsx)(O.b,{variant:"primary",width:"fluid",form:o.uuid,"aria-label":"Lagre endringer",children:"Lagre"}),(0,s.jsx)(w.$n,{type:"button",variant:"secondary","aria-label":"Avbryt sletting",onClick:t,children:"Avbryt"})]})]})]})]})}var P=n(17108),$=n(25411),F=n.n($),V={aimedTime:"Planlagt",arrivalTime:"Ankomst",line:"Linje",destination:"Destinasjon",name:"Stoppested",platform:"Plattform",time:"Forventet"};function G(e){var l=e.isOpen,n=e.setIsOpen;return(0,s.jsxs)(I.aF,{open:l,onDismiss:()=>n(!1),size:"medium",children:[(0,s.jsx)(h.fV,{as:"h1",children:" Dette betyr kolonnene "}),(0,s.jsx)(h.f_,{as:"h2",children:"Planlagt "}),(0,s.jsx)(h.BG,{children:"Rutetid for avgangen til kj\xf8ret\xf8yet. P\xe5virkes ikke av sanntid."}),(0,s.jsx)(h.f_,{as:"h2",children:"Ankomst "}),(0,s.jsx)(h.BG,{children:"N\xe5r kj\xf8ret\xf8yet ankommer stoppestedet. Viser sanntid, hvis det finnes. Hvis ikke vises rutetid."}),(0,s.jsx)(h.f_,{as:"h2",children:"Plattform "}),(0,s.jsx)(h.BG,{children:"Forkortelse for plattform."}),(0,s.jsx)(h.f_,{as:"h2",children:"Forventet "}),(0,s.jsx)(h.BG,{children:"Forventet avgangstid for kj\xf8ret\xf8yet. Viser sanntid, hvis det finnes. Hvis ikke vises rutetid (det samme tidspunktet som vises under “Planlagt”)."})]})}function H(e){var l=e.isCombined,n=(0,D.x)(y._),t=(0,a._)((0,u.useState)(!1),2),i=t[0],r=t[1];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-row items-baseline gap-1",children:[(0,s.jsx)(h.f_,{children:"Kolonner"}),(0,s.jsx)(A.m_,{"aria-hidden":!0,placement:"top",content:"Vis forklaring p\xe5 kolonner",id:"tooltip-columns",children:(0,s.jsx)(w.K0,{type:"button","aria-label":"Vis forklaring p\xe5 kolonner",onClick:()=>r(!0),children:(0,s.jsx)(L.yg0,{})})})]}),(0,s.jsx)(h.BG,{children:"Her bestemmer du hvilke kolonner som skal vises i tavlen."}),l&&(0,s.jsx)(h.BG,{className:"mb-2 !text-error",children:"Har du samlet stoppestedene i \xe9n liste vil du ikke ha mulighet til \xe5 velge kolonner."}),(0,s.jsx)(G,{isOpen:i,setIsOpen:r}),(0,s.jsx)("div",{className:"mb-8 mt-2 flex flex-row flex-wrap gap-4",children:Object.entries(V).map(e=>{var t=(0,a._)(e,2),i=t[0],r=t[1],d=l?x.i2:n.columns;return(0,s.jsx)(P.$7,{name:"columns",value:i,disabled:l,defaultChecked:F()(d)&&d.includes(i),children:r},i)})})]})}var U=n(93343),q=n(6523);function Y(e){var l,n,t,i,r=e.address,d=(0,D.x)(y._),o=Math.ceil((null!=(t=null==(l=d.walkingDistance)?void 0:l.distance)?t:0)/60),c=(0,a._)((0,u.useState)(o===d.offset),2),m=c[0],f=c[1],v=(0,a._)((0,u.useState)(null!=(i=d.offset)?i:""),2),p=v[0],x=v[1];return(0,u.useEffect)(()=>{r||f(!1)},[r]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.f_,{children:"Forskyv avgangstid"}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(h.BG,{children:"Vis kun avganger som g\xe5r om mer enn et valgt antall minutter."}),(0,s.jsx)(q.A,{label:"Antall minutter",name:"offset",id:"offset",type:"number",min:0,className:"!w-full md:!w-1/2 lg:!w-1/4",clearable:!m,onClear:()=>{x("")},value:p,onChange:e=>{x(e.target.valueAsNumber||"")},readOnly:m}),r&&!Number.isNaN(null==(n=d.walkingDistance)?void 0:n.distance)&&(0,s.jsx)(U.Sc,{checked:m,onChange:()=>{var e;m?x(null!=(e=d.offset)?e:""):x(o),f(!m)},children:"Forskyv basert p\xe5 gangavstand"})]})]})}function X(e){var l,n=e.state,i=e.isCombined,r=(0,D.x)(y._),d=(0,a._)((0,u.useState)(null!=(l=r.displayName)?l:""),2),o=d[0],c=d[1],m=!i;return(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(h.f_,{margin:"bottom",children:"Navn p\xe5 stoppested"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h.BG,{margin:"none",children:"Dette navnet vil vises i tavlen."}),(0,s.jsxs)(h.BG,{children:["Det originale navnet til stoppestedet:"," ",r.name.split(",")[0]]}),i&&(0,s.jsx)(h.BG,{className:"!text-error",children:"Har du samlet stoppestedene i \xe9n liste vil du ikke ha mulighet til \xe5 sette navn p\xe5 stoppested."})]}),(0,s.jsx)(q.A,(0,t._)({label:"Navn p\xe5 stoppested",className:"!w-full md:!w-1/2 lg:!w-1/4",name:"displayName",value:o,readOnly:!m,maxLength:50,clearable:m,onClear:()=>{c("")},onChange:e=>c(e.target.value)},(0,j.X)("name",n)))]})}var W=n(84632),z=n(56537);function J(e){var l=e.tile,n=e.transportMode,t=e.lines,i=document.getElementsByName(`${l.uuid}-${n}`),r=t.some(e=>{var n;return null==(n=l.whitelistedLines)?void 0:n.includes(e.id)}),d=t.some(e=>{var n;return!(null==(n=l.whitelistedLines)?void 0:n.includes(e.id))}),o=(0,a._)((0,u.useState)(d&&r?"indeterminate":!l.whitelistedLines||0===l.whitelistedLines.length||!d),2),c=o[0],m=o[1],f=()=>{var e=0,l=!0,n=!1,t=void 0;try{for(var a,s=i.values()[Symbol.iterator]();!(l=(a=s.next()).done);l=!0){var r=a.value;r instanceof HTMLInputElement&&!0===r.checked&&e++}}catch(e){n=!0,t=e}finally{try{l||null==s.return||s.return()}finally{if(n)throw t}}0===e?m(!1):e<i.length?m("indeterminate"):m(!0)};return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex flex-row items-center justify-start gap-4 font-semibold",children:[(0,s.jsx)(k.Rl,{transportMode:n,className:`h-8 w-8 text-${n}`}),(0,z.nI)(n)]}),(0,s.jsx)("div",{className:"divider"}),(0,s.jsx)("div",{className:"flex flex-row items-center",children:(0,s.jsx)(U.Sc,{checked:c,onChange:e=>{m(e.currentTarget.checked),i.forEach(l=>{l instanceof HTMLInputElement&&(l.checked=e.currentTarget.checked)})},children:"Velg alle linjer"})}),t.map(e=>(0,s.jsx)(U.Sc,{name:`${l.uuid}-${n}`,defaultChecked:!l.whitelistedLines||0===l.whitelistedLines.length||l.whitelistedLines.includes(e.id),value:e.id,className:"pl-6",onChange:f,children:(0,s.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[e.publicCode&&(0,s.jsx)("div",{className:"publicCode",children:e.publicCode}),e.name]})},e.id))]})}function Q(e){var l=e.uniqLines,n=e.transportModes,t=(0,D.x)(y._),i=n.map(e=>({transportMode:e,lines:l.filter(l=>l.transportMode===e).sort(z.kO)})).sort((e,l)=>l.lines.length-e.lines.length);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.f_,{children:"Transportmidler og linjer"}),(0,s.jsx)("div",{className:"flex flex-col gap-4 md:flex-row",children:i.map(e=>{var l=e.transportMode,n=e.lines;return(0,s.jsx)(J,{tile:t,transportMode:l,lines:n},l)})}),(0,s.jsx)(W.t,{id:"count",value:l.length.toString()})]})}function K(e){var l=e.index,n=e.totalTiles,t=e.moveItem;return(0,s.jsxs)("div",{className:`flex flex-col ${0!==l||l!==n-1?"justify-center gap-2":"justify-between"}`,children:[0!==l&&(0,s.jsx)(w.Yk,{onClick:()=>{t(l,"up")},"aria-label":"Flytt opp",className:"ml-2 *:!border-gray-300",children:(0,s.jsx)(L.Pc$,{onClick:()=>{t(l,"up")},"aria-label":"Flytt opp"})}),l!==n-1&&(0,s.jsx)(w.Yk,{onClick:()=>{t(l,"down")},"aria-label":"Flytt ned",className:"ml-2 *:!border-gray-300",children:(0,s.jsx)(L.SVl,{})})]})}var Z=n(80291),ee=n(15856);function el(e){var l,n,r,d,o=e.bid,c=e.tile,N=e.index,w=e.address,L=e.demoBoard,A=e.totalTiles,T=e.isCombined,I=e.moveItem,M=e.setDemoBoard,O=(0,a._)((0,u.useState)(!1),2),D=O[0],E=O[1],P=(0,a._)((0,u.useState)(!1),2),$=P[0],F=P[1],V=(0,a._)((0,u.useState)(!1),2),G=V[0],U=V[1],q=(0,v.dj)().addToast,W=(0,a._)((0,u.useActionState)((e,l)=>(0,m._)(function(){var e,n,a,s,r,d,u,m,v,p,h,b,y,k;return(0,f.YH)(this,function(f){switch(f.label){case 0:if(n=l.getAll("columns"),l.delete("columns"),a=l.get("count"),l.delete("count"),s=l.get("offset"),l.delete("offset"),r=l.get("displayName"),l.delete("displayName"),(0,g.gY)(r))return[2,(0,j.f)("board/tiles-name-missing")];d=[],u=!0,m=!1,v=void 0;try{for(p=l.values()[Symbol.iterator]();!(u=(h=p.next()).done);u=!0)b=h.value,d.push(b)}catch(e){m=!0,v=e}finally{try{u||null==p.return||p.return()}finally{if(m)throw v}}if(0===d.length&&null!==a&&a>0)return[2,(0,j.f)("board/tiles-no-lines-selected")];d=d.length==a?[]:d,T&&(n=null!=(y=c.columns)?y:x._X),k=(0,i._)((0,t._)((0,i._)((0,t._)({},c),{columns:n,whitelistedLines:d}),w&&{walkingDistance:{distance:null==(e=c.walkingDistance)?void 0:e.distance}}),{offset:Number(s)||void 0,displayName:r.substring(0,50)||void 0}),f.label=1;case 1:if(f.trys.push([1,5,,6]),"demo"!==o)return[3,2];return es(k),[3,4];case 2:return[4,_(o,k)];case 3:f.sent(),f.label=4;case 4:return el(),[3,6];case 5:return f.sent(),[2,(0,j.f)("board/tiles-save-failed")];case 6:return[2]}})})(),void 0),2),z=W[0],J=W[1],el=()=>{U(!1),F(!1),E(!1)},en=(n=(l=(0,a._)((0,u.useState)(null),2))[0],r=l[1],(0,u.useEffect)(()=>{fetch(Z.Jb["journey-planner"],{headers:{"Content-Type":"application/json","ET-Client-Name":Z.eU},body:JSON.stringify({query:"quay"===c.type?ee.b_:ee.mS,variables:{placeId:c.placeId}}),method:"POST"}).then(e=>e.json()).then(e=>{var l,n,t,i,a,s;"quay"===c.type?r(null!=(s=null==(n=e.data)||null==(l=n.quay)?void 0:l.lines)?s:[]):r((null==(a=e.data)||null==(i=a.stopPlace)||null==(t=i.quays)?void 0:t.flatMap(e=>null==e?void 0:e.lines))||[])})},[c]),n);if(!en)return(0,s.jsx)("div",{className:"flex items-center justify-between rounded bg-blue20 p-4",children:"Laster..."});en=en.filter(e=>!b.includes(e.id));var et=S()(en,"id"),ei=S()(et,"transportMode").map(e=>e.transportMode).sort(),ea=ei.filter(e=>!("coach"===e&&ei.includes("bus"))).map(e=>(0,s.jsx)(k.Rl,{transportMode:e},e)),es=e=>{if(!L)return null;var l=L.tiles.findIndex(l=>l.uuid==e.uuid);if(-1===l)return null;L.tiles[l]=e,M&&M((0,t._)({},L))},er=()=>{if(!L)return null;var e=L.tiles.filter(e=>e.uuid!==c.uuid);M&&M((0,i._)((0,t._)({},L),{tiles:e})),q(`${c.name} fjernet!`)};return(0,s.jsx)("div",{children:(0,s.jsxs)(y._.Provider,{value:c,children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsxs)("div",{className:`flex w-full items-center justify-between bg-blue20 px-6 py-4 ${D?"rounded-t":"rounded"}`,children:[(0,s.jsxs)("div",{className:"flex flex-row items-center gap-4",children:[(0,s.jsx)(h._B,{margin:"none",children:null!=(d=c.displayName)?d:c.name}),(0,s.jsx)("div",{className:"hidden h-8 flex-row gap-4 sm:flex",children:ea})]}),(0,s.jsx)(B,{hasTileChanged:$,isTileOpen:D,setIsTileOpen:E,setConfirmOpen:U,deleteTile:()=>"demo"===o?er():C(o,c).then(()=>{q(`${c.name} fjernet!`)})})]}),(0,s.jsx)(K,{index:N,totalTiles:A,moveItem:I})]}),(0,s.jsx)(p.mE,{open:D,children:(0,s.jsx)("div",{className:`mr-14 bg-blue10 px-6 py-4 ${1==A&&"w-full"} rounded-b`,children:(0,s.jsxs)("form",{id:c.uuid,onSubmit:e=>{e.preventDefault();var l=new FormData(e.currentTarget);(0,u.startTransition)(()=>{J(l)})},onInput:()=>F(!0),children:[(0,s.jsx)(X,{state:z,isCombined:T}),(0,s.jsx)(Y,{address:w}),(0,s.jsx)(H,{isCombined:T}),(0,s.jsx)(Q,{uniqLines:et,transportModes:ei}),(0,s.jsx)(R,{confirmOpen:G,hasTileChanged:$,resetTile:el,setIsTileOpen:E,setConfirmOpen:U,validation:z,deleteTile:()=>"demo"===o?er():C(o,c).then(()=>{q(`${c.name} fjernet!`)})})]})})})]})})}function en(e){var l=e.board,n=e.setDemoBoard,r=e.bid,o=(0,a._)((0,u.useState)(l.tiles),2),m=o[0],f=o[1];(0,u.useEffect)(()=>{f(l.tiles)},[l.tiles]);var v=c()((e,a)=>{var s,o="up"===a?e-1:e+1;if(!(o<0)&&!(o>=l.tiles.length)){var c=[...l.tiles],u=c[o];if(c[o]=c[e],c[e]=u,f(c),"demo"===r&&n){var m=(0,i._)((0,t._)({},l),{tiles:c});n(null!=m?m:l)}else d(null!=(s=l.id)?s:"",c)}},150);return(0,s.jsx)("div",{className:"flex flex-col gap-4",children:m.map((e,t)=>{var i;return(0,s.jsx)(el,{bid:null!=(i=null!=r?r:l.id)?i:"",demoBoard:r?l:void 0,tile:e,address:l.meta.location,moveItem:v,index:t,totalTiles:l.tiles.length,setDemoBoard:n,isCombined:!!l.combinedTiles},e.uuid)})})}}}]);